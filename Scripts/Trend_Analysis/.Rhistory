#Standarise column names
janitor::clean_names() %>%
#Select columns of interest
select(matches(".*name.*") | matches(".*details.*") | contains("breath"))
TracingForm %>%
#Standarise column names
janitor::clean_names() %>%
#Select columns of interest
select(matches(".*name.*") | matches(".*details.*") | contains("breath")) %>%
#Remove any rows with no data
drop_na()
#Creating a new data frame with email addresses that are not currently in our members list
TracingForm %>%
#Standarise column names
janitor::clean_names() %>%
#Select columns of interest
select(matches(".*name.*") | matches(".*details.*") | contains("breath")) %>%
#Remove any rows with no data
drop_na() %>%
#Select names and emails only
select(first_name:best_contact_details_e_g_mobile_or_email) %>%
#Merging column names
unite("name", first_name, last_name, sep = " ", remove = F) %>%
#Capitalising names correctly
mutate_at(vars(contains("name")), str_to_title) %>%
#Select rows from tracing form that do not appear in the members list
anti_join(members, by = "name") %>%
select(-name) -> toBeContacted
#Getting details of the location the 'MailMerge' file in our Google Drive
ss <- googledrive::drive_get("MailMerge")
#Write the data frame of emails to be sent into the new Google Sheet
toBeContacted %>%
#Adding the name of the new tab to be created to avoid overwriting already existing data
sheet_write(ss, sheet = "Reproducibility_event")
# Loading libraries -------------------------------------------------------
# library(ncdf4)
# library(sf)
library(tidyverse)
library(nlme)
library(magrittr)
# Setting up data into R --------------------------------------------------
#Getting list of csv files
filelist <- list.files(path = "Data/", pattern = ".csv$", full.names = T)
# Setting up data into R --------------------------------------------------
#Getting list of csv files
filelist <- list.files(path = "Data/", pattern = ".csv$", full.names = T)
#Reading files
for(i in filelist){
var_int <- str_match(i, pattern = "\\/([A-Z]*)\\.csv")[2]
assign(var_int, read.csv(filelist))
}
Atl_MLD <- read.csv(filelist[1])
filelist
Atl_MLD <- read.csv(filelist[1])
CentInd_MLD <- read.csv(filelist[2])
EastInd_MLD <- read.csv(filelist[3])
EP_MLD <- read.csv(filelist[4])
WP_MLD <- read.csv(filelist[5])
#Months into which data will be divided
months1 <- month.abb[5:9]
data <- Atl_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
summary(fit_LM)
coef_LM <- summary(fit_LM)$coefficients
data_season <- data %>%
group_by(group) %>%
summarise(obs = mean(obs), MLD = mean(MLD))
fit_LM_season <- data_season %$%
lm(MLD~obs)
summary(fit_LM_season)
coef_LM_season <-summary(fit_LM_season)$coefficients
data.confInt <- predict(fit_LM_season, interval="confidence", data = data_season) %>%
as_tibble() %>%
bind_cols(data_season, .)
fit_AR1 <- gls(MLD~obs, correlation = corAR1(), data = data)
coeff_AR1 <- summary(fit_AR1)$tTable
data_SLA.LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM, newdata = .))
data_SLA.MB_LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM_season, newdata = .))
data_SLA.AR1 <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_AR1, newdata = .))
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(10, 50,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(97,35, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(97,22, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(97,9, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
legend(5, 350,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
legend(1, 350,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,345, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,342, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,325, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,323, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,300, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
legend(1, 50,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
legend(1, 60,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,50, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,48, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,45, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,40, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,25, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,26, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,24, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(97, 1, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(97, 10, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,10, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,1, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
text(1, 300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(10, 300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(20, 300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,24, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
text(20, 300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
# data <- Atl_MLD %>%
data <- CentInd_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
summary(fit_LM)
coef_LM <- summary(fit_LM)$coefficients
data_season <- data %>%
group_by(group) %>%
summarise(obs = mean(obs), MLD = mean(MLD))
fit_LM_season <- data_season %$%
lm(MLD~obs)
summary(fit_LM_season)
coef_LM_season <-summary(fit_LM_season)$coefficients
data.confInt <- predict(fit_LM_season, interval="confidence", data = data_season) %>%
as_tibble() %>%
bind_cols(data_season, .)
fit_AR1 <- gls(MLD~obs, correlation = corAR1(), data = data)
coeff_AR1 <- summary(fit_AR1)$tTable
data_SLA.LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM, newdata = .))
data_SLA.MB_LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM_season, newdata = .))
data_SLA.AR1 <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_AR1, newdata = .))
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# data <- Atl_MLD %>%
# data <- CentInd_MLD %>%
data <- EastInd_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
summary(fit_LM)
coef_LM <- summary(fit_LM)$coefficients
data_season <- data %>%
group_by(group) %>%
summarise(obs = mean(obs), MLD = mean(MLD))
fit_LM_season <- data_season %$%
lm(MLD~obs)
summary(fit_LM_season)
coef_LM_season <-summary(fit_LM_season)$coefficients
data.confInt <- predict(fit_LM_season, interval="confidence", data = data_season) %>%
as_tibble() %>%
bind_cols(data_season, .)
fit_AR1 <- gls(MLD~obs, correlation = corAR1(), data = data)
coeff_AR1 <- summary(fit_AR1)$tTable
data_SLA.LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM, newdata = .))
data_SLA.MB_LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM_season, newdata = .))
data_SLA.AR1 <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_AR1, newdata = .))
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries East Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# data <- Atl_MLD %>%
# data <- CentInd_MLD %>%
# data <- EastInd_MLD %>%
data <- EastInd_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
# data <- Atl_MLD %>%
# data <- CentInd_MLD %>%
# data <- EastInd_MLD %>%
data <- EP_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
summary(fit_LM)
coef_LM <- summary(fit_LM)$coefficients
data_season <- data %>%
group_by(group) %>%
summarise(obs = mean(obs), MLD = mean(MLD))
fit_LM_season <- data_season %$%
lm(MLD~obs)
summary(fit_LM_season)
coef_LM_season <-summary(fit_LM_season)$coefficients
data.confInt <- predict(fit_LM_season, interval="confidence", data = data_season) %>%
as_tibble() %>%
bind_cols(data_season, .)
fit_AR1 <- gls(MLD~obs, correlation = corAR1(), data = data)
coeff_AR1 <- summary(fit_AR1)$tTable
data_SLA.LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM, newdata = .))
data_SLA.MB_LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM_season, newdata = .))
data_SLA.AR1 <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_AR1, newdata = .))
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,325, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,330, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,340, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,340, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries East Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries East Pacific Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# data <- Atl_MLD %>%
# data <- CentInd_MLD %>%
# data <- EastInd_MLD %>%
# data <- EP_MLD %>%
data <- WP_MLD %>%
rename("MLD" = "X0") %>%
mutate(month = month.abb[month]) %>%
filter(month %in% months1) %>%
rowid_to_column("obs") %>%
mutate(group = (obs-1)%/%length(months1))
fit_LM <- data %$%
lm(MLD ~ obs)
summary(fit_LM)
coef_LM <- summary(fit_LM)$coefficients
data_season <- data %>%
group_by(group) %>%
summarise(obs = mean(obs), MLD = mean(MLD))
fit_LM_season <- data_season %$%
lm(MLD~obs)
summary(fit_LM_season)
coef_LM_season <-summary(fit_LM_season)$coefficients
data.confInt <- predict(fit_LM_season, interval="confidence", data = data_season) %>%
as_tibble() %>%
bind_cols(data_season, .)
fit_AR1 <- gls(MLD~obs, correlation = corAR1(), data = data)
coeff_AR1 <- summary(fit_AR1)$tTable
data_SLA.LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM, newdata = .))
data_SLA.MB_LM <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_LM_season, newdata = .))
data_SLA.AR1 <- data.frame(obs = data$obs) %>%
mutate(SLA = predict(fit_AR1, newdata = .))
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(40,340, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                     round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,60, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(40,340, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                     round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,70, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
dev.off()
plot(MLD~obs,data = data, xlab="Timesteps", ylab = "Mixed layer depth (MLD, m) ",
pch=19,cex=0.5,col="black", ylim =c(0,350))
polygon(c(data.confInt$obs, rev(data.confInt$obs)), c(data.confInt$lwr, rev(data.confInt$upr)),
col=adjustcolor("grey80",alpha.f=0.5),border=NA)
lines(MLD~obs,data=data, col="azure3", lwd=0.5)
lines(SLA~obs,data=data_SLA.LM, lwd=1,col="dodgerblue4")
lines(SLA~obs,data=data_SLA.MB_LM, lwd=1,col="chocolate1")
lines(SLA~obs,data=data_SLA.AR1, lwd=1,col="chartreuse")
points(MLD~obs,data=data_season,pch=19,cex=0.8,col="chocolate1")
legend(1, 70,c("Linear regression (LM)","Moving Block LM","Autoregressive (AR1)"), lwd=c(1,1,1),
col=c("dodgerblue4","chocolate1","chartreuse"), y.intersp=0.8,box.lty=0,bg="transparent",cex=0.8)
text(40,42, paste0("p-value = ", round(coef_LM[2,4], 3)),cex=0.8)
# text(97,35, "p-value < 0.001", cex=0.8)
text(40,20, paste0("p-value = ", round(coef_LM_season[2,4], 3)),cex=0.8)
# text(97,22, "p-value < 0.001", cex=0.8)
text(40,0, paste0("p-value = ", round(coeff_AR1[2,4], 3)),cex=0.8)
# text(15,300, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                      round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# text(40,340, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
#                     round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
text(40,70, paste0("Trend = ", round(coef_LM_season[2,1]*12, 2),"m/year ±",
round(coef_LM_season[2,2]*12, 2)),cex=0.8,font=2)
# title("1965-2018 MLD timeseries Atlantic Sector (May-Sep) with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries Central Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries East Indian Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
# title("1965-2018 MLD timeseries East Pacific Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
title("1965-2018 MLD timeseries West Pacific Sector (May-Sep) \n with fits and estimated trend",cex.main=0.9)
